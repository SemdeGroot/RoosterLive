{% extends "two_factor/_base.html" %}
{% load i18n static %}

{% block pre_body %}
  {% if show_splash %}
    {% include "includes/splash.html" %}
  {% endif %}
{% endblock %}

{% block login_header_image %}
  {% load static %}
  {% if form.otp_token or form.token %}
    <div class="twofa-image-wrap">
      <img src="{% static 'img/2FA.png' %}" alt="2FA" class="twofa-image">
    </div>
  {% else %}
    <div class="logo-wrap default-logo">
      {% static 'img/logo.jpg' as static_logo %}
      <img class="logo" src="{% firstof logo_url static_logo %}" alt="Apotheek Jansen">
    </div>
  {% endif %}
{% endblock %}

{% block content %}

  {# GEEN messages hier: _base.html rendert ze al #}

  <form method="post" autocomplete="off" novalidate>
    {% csrf_token %}
    {{ wizard.management_form }}

    {# STAP 1: username + password #}
    {% if form.username and form.password %}
      <label for="{{ form.username.id_for_label }}">Voornaam / E-mail</label>
      {{ form.username }}

      <label for="{{ form.password.id_for_label }}">Wachtwoord</label>
      {{ form.password }}

      <button type="submit">{% trans "Inloggen" %}</button>

    {# STAP 2: TOTP code (veldnaam kan otp_token of token heten) #}
    {% elif form.otp_token or form.token %}
      <h1 style="text-align:center;">{% trans "Voer je 2FA-code in" %}</h1>
      <p class="twofa-logintext muted">
        Open je authenticator app en vul de 6-cijferige code in.
      </p>

      {% if form.otp_token %}
        <label for="{{ form.otp_token.id_for_label }}">6-cijferige code</label>
        {{ form.otp_token }}
      {% else %}
        <label for="{{ form.token.id_for_label }}">6-cijferige code</label>
        {{ form.token }}
      {% endif %}

      <button type="submit">{% trans "Bevestigen" %}</button>

    {% endif %}
  </form>

{% endblock %}
