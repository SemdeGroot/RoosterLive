{% extends "two_factor/_base.html" %}
{% load i18n static %}

{% block login_header_image %}
  <div class="twofa-image-wrap">
    <img src="{% static 'img/2FA.png' %}" alt="2FA" class="twofa-image">
  </div>
{% endblock %}

{% block content %}
  <h1 style="text-align:center;">{% trans "2FA instellen" %}</h1>
  <p class="muted" style="text-align:center;max-width:48rem;margin:0 auto;">
    Scan deze QR-code met een authenticator app (bijv. Google Authenticator) en vul daarna de 6-cijferige code in.
  </p>

  <div class="twofa-stack">
    <div class="qr-wrap">
      <div class="qr-card">
        <img src="{% url 'two_factor:qr' %}" alt="2FA QR-code" class="qr-image">
      </div>

      {% firstof secret_key otp_secret_key as secret %}
      {% if secret %}
        <div class="manual-secret muted">
          <div>Geheime sleutel:</div>
          <code>{{ secret }}</code>
        </div>
      {% endif %}
    </div>

    <p class="twofa-help muted">
      Kun je niet scannen? Voeg de geheime sleutel handmatig toe in je app en kies tijdgebaseerde (TOTP) codes.
    </p>

    <form method="post" novalidate autocomplete="one-time-code" class="twofa-form">
      {% csrf_token %}
      {{ wizard.management_form }}

      {# MyTOTPDeviceForm gebruikt het veld 'token' (niet otp_token) #}
    <label for="{{ form.token.id_for_label }}">6-cijferige code</label>
    {{ form.token }}

      <button type="submit">{% trans "Bevestigen" %}</button>
    </form>
  </div>
{% endblock %}
