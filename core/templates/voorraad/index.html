{% extends "base.html" %}
{% load static %}
{% block title %}{{ title }}{% endblock %}
{% block header_title %}{{ title }}{% endblock %}

{% block head %}
  <link rel="stylesheet" href="{% static 'css/voorraad/voorraad.css' %}">
{% endblock %}

{% block content %}
<div class="card" style="padding:16px;">

  {% if perms.core.can_upload_voorraad %}
  <form method="post" enctype="multipart/form-data" class="uploader" id="medForm">
    {% csrf_token %}
    <input type="file" id="medFile" name="file" accept=".csv,.xlsx,.xls" hidden required>

    <div class="dropzone" id="medDrop" onclick="document.getElementById('medFile').click()">
      <div class="dz-icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
          <path d="M14 2v6h6"/>
          <path d="M12 12v6"/>
          <path d="M9 15h6"/>
        </svg>
      </div>
      <div class="dz-text">
        <div class="dz-title">Sleep je voorraad bestand hierheen of klik om te kiezen. Zorg dat kolom 1 de ZI-nummers bevat en kolom 2 de medicijnnamen</div>
        <div class="dz-hint">
          Alleen .csv / .xlsx / .xls - Het nieuwe bestand vervangt automatisch het oude <strong>zodra je op Uploaden klikt.</strong>
        </div>
      </div>
    </div>

    <div class="file-meta" id="medMeta" style="display:none;">
      Geselecteerd: <span class="file-name" id="medName"></span>
    </div>

    <div class="u-actions">
      <button class="btn" type="submit" id="medUpload" disabled>Uploaden</button>
      <button type="button" class="btn ghost" id="medClear" style="display:none;">Wissen</button>
    </div>
  </form>
  {% endif %}

  <div class="search-row">
    <input id="medSearch" type="text" placeholder="Typ om te zoeken...">
  </div>

  {% if rows %}
    <div class="table-wrap">
      <table class="manage-table" id="medTable">
        <thead>
          <tr>{% for c in columns %}<th>{{ c }}</th>{% endfor %}</tr>
        </thead>
        <tbody>
          {% for r in rows %}
            <tr>{% for cell in r %}<td>{{ cell }}</td>{% endfor %}</tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="table-footer">
      <button type="button" class="toggle-btn" id="medToggle" style="display:none;">Toon meer</button>
    </div>
  {% else %}
    <p style="color:var(--muted); margin:8px 0 0;">Nog geen bestand ge√ºpload.</p>
  {% endif %}
</div>

<script src="{% static 'js/voorraad/voorraad.js' %}" defer></script>
{% endblock %}