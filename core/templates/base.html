{% load static %}
{% load menu_tiles %}
{% if debug %}
  <script src="{% static 'django_browser_reload/reload.js' %}"></script>
{% endif %}
<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <!-- notch + goede zoom -->
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />

  <title>{% block title %}Rooster{% endblock %}</title>

  <meta name="description" content="Mijn Apotheek Jansen Portaal" />
  <meta name="application-name" content="Mijn Apotheek Jansen Portaal" />
  <meta name="apple-mobile-web-app-title" content="Mijn Apotheek Jansen Portaal" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />

  <!-- kleur adresbalk / titelbalk -->
  <meta name="theme-color" content="#10161d">
  <meta name="color-scheme" content="dark light" />

  <link rel="stylesheet" href="{% static 'css/base/base.css' %}">

  <!-- Manifest + icons -->
  <link rel="manifest" href="{% static 'pwa/manifest.webmanifest' %}">
  <link rel="icon" type="image/png" sizes="32x32" href="{% static 'pwa/icons/icon-192.png' %}">
  <link rel="apple-touch-icon" href="{% static 'pwa/icons/icon-180.png' %}">

  {% block head %}{% endblock %}
</head>
<body>
    <div class="app">
        <header class="header">
            <a href="{% url 'home' %}" class="logo-wrap">
                <img class="logo" src="{% static 'img/logo.jpg' %}" alt="Logo">
            </a>

            <div class="title-wrapper">
                <h1 class="title">{% block header_title %}{{ page_title|default:"Rooster" }}{% endblock %}</h1>
            </div>

            <!-- Hamburger knop (mobiel) -->
            <button class="nav-toggle" id="navToggle" aria-label="Open navigatie" aria-controls="navPanel" aria-expanded="false">
                <span class="burger-line burger-line-1"></span>
                <span class="burger-line burger-line-2"></span>
                <span class="burger-line burger-line-3"></span>
            </button>

            <!-- Desktop nav (onder logo/titel, wrappend) -->
            <nav class="nav" aria-label="Hoofdmenu">
                {% user_tiles as tiles_for_nav %}
                {% for t in tiles_for_nav %}
                    <a href="{% url t.url_name %}"
                    {% if request.resolver_match.url_name == t.url_name %}class="active"{% endif %}>
                    {{ t.name }}
                    </a>
                {% endfor %}

                {% if request.user.is_authenticated %}
                    <form action="{% url 'logout' %}" method="post" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" class="nav-btn">Uitloggen</button>
                    </form>
                {% else %}
                    <a href="{% url 'login' %}">Login</a>
                {% endif %}
            </nav>
        </header>

        <!-- Overlay voor mobiel menu -->
        <div class="nav-overlay" id="navOverlay"></div>

        <!-- Mobiel paneel nav -->
        <nav class="nav-panel" id="navPanel" hidden aria-label="Hoofdmenu mobiel">
        <div class="nav-panel-header">
            <span class="nav-panel-title">Menu</span>
            <button class="nav-close" id="navClose" aria-label="Sluit menu">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
            </button>
        </div>

        <div class="nav-links">
            {% user_tiles as tiles_for_nav %}
            {% for t in tiles_for_nav %}
            <a href="{% url t.url_name %}" 
                class="nav-link {% if request.resolver_match.url_name == t.url_name %}active{% endif %}">
                <span class="nav-icon" 
                    style="--icon: url('{% static 'img/' %}{{ t.img }}')"></span>
                <span>{{ t.name }}</span>
            </a>
            {% endfor %}

            <div class="nav-divider"></div>
            {% if request.user.is_authenticated %}
                <form action="{% url 'logout' %}" method="post">
                {% csrf_token %}
                <button type="submit" class="nav-link nav-logout">Uitloggen</button>
                </form>
            {% else %}
                <a href="{% url 'login' %}" class="nav-link">Login</a>
            {% endif %}
            </div>
        </nav>

        <main class="content">
            {% for m in messages %}<div class="flash">{{ m }}</div>{% endfor %}
            {% block content %}{% endblock %}
        </main>

        <footer class="footer">
            <div>Â© {% now "Y" %} Apotheek Jansen Amersfoort - Sem de Groot</div>
        </footer>
    </div>
    <script src="{% static 'js/base/base.js' %}" defer></script>
</body>
</html>
