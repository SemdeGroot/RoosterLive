{% extends "two_factor/_base.html" %}
{% load static i18n %}

{% block head %}
  <link rel="stylesheet" href="{% static 'css/auth/set_password.css' %}">
{% endblock %}

{% block login_header_image %}
  {% static 'img/logo.jpg' as static_logo %}
  <div class="logo-wrap default-logo">
    <img class="logo" src="{% firstof logo_url static_logo %}" alt="Apotheek Jansen">
  </div>
{% endblock %}

{% block content %}

  <form method="post"
        autocomplete="off"
        novalidate
        id="set-password-form"
        data-min-length="{{ min_length|default:8 }}">
    {% csrf_token %}

    <h1>{% trans "Stel je wachtwoord in" %}</h1>
    <p class="twofa-logintext muted">
      {% trans "Kies een sterk wachtwoord. Je wordt hierna doorgestuurd om 2FA in te stellen." %}
    </p>

    <label for="{{ form.new_password1.id_for_label }}">{% trans "Wachtwoord" %}</label>
    {{ form.new_password1 }}

    {# Sterkte-meter met badge + info-hover (tooltip) #}
    <div class="pw-meter">
      <div class="pw-meter-top">
        <div class="pw-badge" id="pw-badge">
          <span class="pw-badge-dot"></span>
          <span class="pw-badge-text" id="pw-strength-text">Sterkte: â€”</span>
        </div>

        <div class="pw-info" aria-label="Wachtwoordtips" tabindex="0">
          <!-- Lucide info SVG -->
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
              stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="16" x2="12" y2="12"></line>
            <line x1="12" y1="8"  x2="12.01" y2="8"></line>
          </svg>
          <div class="pw-tooltip" role="tooltip">
            <div class="pw-tooltip-title">{% trans "Wachtwoordvereisten" %}</div>
            <ul class="pw-hints" id="pw-hints">
              <li data-check="length">
                {% trans "Minimale lengte" %} <span>(</span><span id="pw-min">8</span><span>)</span>
              </li>
              <li data-check="not-numeric">{% trans "Mag niet alleen uit cijfers bestaan" %}</li>
              <li data-check="not-common">{% trans "Geen veelvoorkomend wachtwoord" %}</li>
              <li data-check="variety">{% trans "Gebruik letters, cijfers en tekens" %}</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="pw-bar">
        <div class="pw-bar-fill" id="pw-bar-fill" aria-hidden="true"></div>
      </div>
    </div>


    <label for="{{ form.new_password2.id_for_label }}">{% trans "Herhaal wachtwoord" %}</label>
    {{ form.new_password2 }}
    <div id="pw-match" class="pw-match" aria-live="polite"></div>

    <button type="submit" id="pw-submit">{% trans "Opslaan en 2FA instellen" %}</button>
  </form>

  <script src="{% static 'js/auth/set_password.js' %}"></script>
{% endblock %}